(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4eb27613"],{dc3f:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["login-wrapper",["","login-form-right","login-form-left"][e.direction]]},[r("el-form",{ref:"loginForm",staticClass:"login-form ele-bg-white",attrs:{model:e.form,rules:e.rules,size:"large"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSubmit.apply(null,arguments)}}},[r("h4",[e._v("登录")]),r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{attrs:{placeholder:"请输入登录账号","prefix-icon":"el-icon-user",clearable:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{attrs:{placeholder:"请输入登录密码","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),r("div",{staticClass:"el-form-item"}),r("div",{staticClass:"el-form-item"},[r("el-button",{attrs:{loading:e.loading,type:"primary",size:"medium"},on:{click:e.doSubmit}},[e._v(" "+e._s(e.loading?"登录中":"登录")+" ")]),r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.$router.push("/register")}}},[e._v(" 注册 ")]),r("el-button",{attrs:{type:"success",size:"medium"},on:{click:function(t){return e.lineLogin()}}},[e._v(" line登录 ")])],1)],1)],1)},o=[],n={name:"Login",data:function(){return{direction:1,loading:!1,form:{username:"",password:"",remember:!0},rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},mounted:function(){var e=this;this.$store.state.user.token&&this.$router.push(this.$route.query.from||"/"),this.$route.query.code&&this.$route.query.state&&this.$http.get("/line/callback?code="+this.$route.query.code+"&state="+this.$route.query.state).then((function(t){var r=t.data.data,s=t.data.code,o=t.data.message;e.loading=!1,200===s?r.token_type&&r.access_token?(e.$message({type:"success",message:"登录成功"}),e.$store.dispatch("user/setToken",r.token_type+" "+r.access_token).then((function(){e.$router.push(e.$route.query.from||"/").catch((function(){}))}))):e.$message({type:"success",message:"绑定成功"}):e.$message.error(o)})).catch((function(t){e.$message.error(t.message)}))},methods:{doSubmit:function(){var e=this;this.$refs["loginForm"].validate((function(t){if(!t)return!1;e.loading=!0,e.$http.post("/auth/login",e.form).then((function(t){var r=t.data.data,s=t.data.code,o=t.data.message;e.loading=!1,200===s?(e.$message({type:"success",message:"登录成功"}),e.$store.dispatch("user/setToken",r.token_type+" "+r.access_token).then((function(){e.$router.push(e.$route.query.from||"/").catch((function(){}))}))):e.$message.error(o)})).catch((function(t){console.log(t),e.loading=!1,e.$message.error("用户名或密码不正确")}))}))},lineLogin:function(){var e=this;this.$http.get("/login/line",this.form).then((function(e){window.location.href=e.data.url})).catch((function(t){console.log(t),e.$message.error("网络错误")}))}}},a=n,i=(r("df6d"),r("2877")),u=Object(i["a"])(a,s,o,!1,null,"3049da22",null);t["default"]=u.exports},df6d:function(e,t,r){"use strict";r("fa1b")},fa1b:function(e,t,r){}}]);